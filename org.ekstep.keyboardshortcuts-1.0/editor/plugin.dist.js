org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.keyboardshortcuts","ver":"1.0","author":"Akash Gupta","editor":{"main":"editor/plugin.js","dependencies":[{"type":"template","src":"./templates/shortcutspopup.html","bundle":true}]}},org.ekstep.contenteditor.basePlugin.extend({type:"shortcuts",isPopupOpen:!1,events:{copyElem:"copy:copyItem",pasteElem:"paste:pasteItem",deleteElem:"delete:invoke",createStage:"stage:create",duplicateStage:"stage:duplicate",saveContent:"org.ekstep.contenteditor:save",selectStage:"stage:select",sendToBack:"reorder:sendback",sendToFront:"reorder:bringfront"},initialize:function(){var r=this,t=ecEditor.resolvePluginResource(r.manifest.id,r.manifest.ver,"editor/templates/shortcutspopup.html");ecEditor.getService("popup").loadNgModules(t),ecEditor.registerKeyboardCommand("mod+c",function(e){e.preventDefault(),ecEditor.dispatchEvent(r.events.copyElem)}),ecEditor.registerKeyboardCommand("mod+v",function(e){e.preventDefault(),ecEditor.dispatchEvent(r.events.pasteElem),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}),ecEditor.registerKeyboardCommand(["del","backspace"],function(e){e.preventDefault(),ecEditor.dispatchEvent(r.events.deleteElem),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}),ecEditor.registerKeyboardCommand("ctrl+m",function(e){e.preventDefault(),ecEditor.dispatchEvent(r.events.createStage,{position:"afterCurrent"}),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}),ecEditor.registerKeyboardCommand("mod+d",function(e){e.preventDefault(),ecEditor.dispatchEvent(r.events.duplicateStage,{stageId:org.ekstep.contenteditor.api.getCurrentStage().id}),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}),ecEditor.registerKeyboardCommand("mod+x",function(e){e.preventDefault(),ecEditor.dispatchEvent(r.events.copyElem),ecEditor.dispatchEvent(r.events.deleteElem)}),ecEditor.registerKeyboardCommand("mod+a",function(e){e.preventDefault();var t=org.ekstep.contenteditor.api.getCanvas();t.deactivateAll();var r=t.getObjects().map(function(e){return e.set("active",!0)}),o=new fabric.Group(r,{originX:"left",originY:"top"});t.setActiveGroup(o.setCoords()).renderAll()}),org.ekstep.contenteditor.api.getCanvas().on("object:moving",r.moveRichText),ecEditor.registerKeyboardCommand("mod+s",function(e){e.preventDefault(),ecEditor.dispatchEvent(r.events.saveContent)}),ecEditor.registerKeyboardCommand("mod+/",function(e){e.preventDefault();if(!r.isPopupOpen)ecEditor.getService("popup").open({templateUrl:t,controller:["$scope",function(e){e.$on("ngDialog.opened",function(e,t){r.isPopupOpen=!0})}],width:900,showClose:!0,className:"ngdialog-theme-default"},function(){r.isPopupOpen=!1})}),ecEditor.registerKeyboardCommand(["home","command+up"],function(e){e.preventDefault(),ecEditor.dispatchEvent(r.events.selectStage,{prevStageId:org.ekstep.contenteditor.api.getCurrentStage().id,stageId:org.ekstep.contenteditor.api.getAllStages()[0].id})}),ecEditor.registerKeyboardCommand(["end","command+down"],function(e){e.preventDefault(),ecEditor.dispatchEvent(r.events.selectStage,{prevStageId:org.ekstep.contenteditor.api.getCurrentStage().id,stageId:org.ekstep.contenteditor.stageManager.stages[org.ekstep.contenteditor.stageManager.stages.length-1].id})}),ecEditor.registerKeyboardCommand("mod+b",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject();t&&(e.preventDefault(),t.onConfigChange("fontweight","bold"),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()}))}),ecEditor.registerKeyboardCommand("mod+i",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject();t&&(e.preventDefault(),t.onConfigChange("fontstyle","italic"),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()}))}),ecEditor.registerKeyboardCommand("mod+shift+.",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject();if(t){e.preventDefault();var r=t.getConfig().fontsize;r=parseInt(r,10),t.onConfigChange("fontsize",r+1),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}}),ecEditor.registerKeyboardCommand("mod+shift+,",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject();if(t){e.preventDefault();var r=t.getConfig().fontsize;r=parseInt(r,10),t.onConfigChange("fontsize",r-1),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}}),ecEditor.registerKeyboardCommand("mod+alt+shift+l",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject();t&&(e.preventDefault(),t.onConfigChange("align","left"),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()}))}),ecEditor.registerKeyboardCommand("mod+alt+shift+r",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject();t&&(e.preventDefault(),t.onConfigChange("align","right"),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()}))}),ecEditor.registerKeyboardCommand("mod+alt+shift+e",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject();t&&(e.preventDefault(),t.onConfigChange("align","center"),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()}))}),ecEditor.registerKeyboardCommand("mod+down",function(e){e.preventDefault(),ecEditor.dispatchEvent(r.events.sendToBack),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}),ecEditor.registerKeyboardCommand("mod+up",function(e){e.preventDefault(),ecEditor.dispatchEvent(r.events.sendToFront),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}),ecEditor.registerKeyboardCommand("up",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject(),r=org.ekstep.contenteditor.api.getEditorGroup();if(r)e.preventDefault(),_.each(org.ekstep.contenteditor.api.getCurrentGroup(),function(e){var t=ecEditor.jQuery("#"+e.id);0!=t.length&&(t[0].style.top=parseInt(t[0].style.top,10)-3+"px"),e.setAttribute("y",e.attributes.y-3)}),r.top=r.top-3,org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()});else if(t){e.preventDefault();var o=ecEditor.jQuery("#"+t.id);0!=o.length&&(o[0].style.top=parseInt(o[0].style.top,10)-3+"px"),t.editorObj.top=t.editorObj.top-3,t.setAttribute("y",t.editorObj.top),org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}}),ecEditor.registerKeyboardCommand("down",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject(),r=org.ekstep.contenteditor.api.getEditorGroup();if(r)e.preventDefault(),_.each(org.ekstep.contenteditor.api.getCurrentGroup(),function(e){var t=ecEditor.jQuery("#"+e.id);0!=t.length&&(t[0].style.top=parseInt(t[0].style.top,10)+3+"px"),e.setAttribute("y",e.attributes.y+3)}),r.top=r.top+3,org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()});else if(t){e.preventDefault();var o=ecEditor.jQuery("#"+t.id);0!=o.length&&(o[0].style.top=parseInt(o[0].style.top,10)+3+"px"),t.editorObj.top=t.editorObj.top+3,t.setAttribute("y",t.editorObj.top),org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}}),ecEditor.registerKeyboardCommand("left",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject(),r=org.ekstep.contenteditor.api.getEditorGroup();if(r)e.preventDefault(),_.each(org.ekstep.contenteditor.api.getCurrentGroup(),function(e){var t=ecEditor.jQuery("#"+e.id);0!=t.length&&(t[0].style.left=parseInt(t[0].style.left,10)-3+"px"),e.setAttribute("x",e.attributes.x-3)}),r.left=r.left-3,org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()});else if(t){e.preventDefault();var o=ecEditor.jQuery("#"+t.id);0!=o.length&&(o[0].style.left=parseInt(o[0].style.left,10)-3+"px"),t.editorObj.left=t.editorObj.left-3,t.setAttribute("x",t.editorObj.left),org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}}),ecEditor.registerKeyboardCommand("right",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject(),r=org.ekstep.contenteditor.api.getEditorGroup();if(r)e.preventDefault(),_.each(org.ekstep.contenteditor.api.getCurrentGroup(),function(e){var t=ecEditor.jQuery("#"+e.id);0!=t.length&&(t[0].style.left=parseInt(t[0].style.left,10)+3+"px"),e.setAttribute("x",e.attributes.x+3)}),r.left=r.left+3,org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()});else if(t){e.preventDefault();var o=ecEditor.jQuery("#"+t.id);0!=o.length&&(o[0].style.left=parseInt(o[0].style.left,10)+3+"px"),t.editorObj.left=t.editorObj.left+3,t.setAttribute("x",t.editorObj.left),org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}}),ecEditor.registerKeyboardCommand("shift+up",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject(),r=org.ekstep.contenteditor.api.getEditorGroup();if(r)e.preventDefault(),_.each(org.ekstep.contenteditor.api.getCurrentGroup(),function(e){var t=ecEditor.jQuery("#"+e.id);0!=t.length&&(t[0].style.top=parseInt(t[0].style.top,10)-1+"px"),e.setAttribute("x",e.attributes.x-1)}),r.top=r.top-1,org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()});else if(t){e.preventDefault();var o=ecEditor.jQuery("#"+t.id);0!=o.length&&(o[0].style.top=parseInt(o[0].style.top,10)-1+"px"),t.editorObj.top=t.editorObj.top-1,t.setAttribute("y",t.editorObj.top),org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}}),ecEditor.registerKeyboardCommand("shift+down",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject(),r=org.ekstep.contenteditor.api.getEditorGroup();if(r)e.preventDefault(),_.each(org.ekstep.contenteditor.api.getCurrentGroup(),function(e){var t=ecEditor.jQuery("#"+e.id);0!=t.length&&(t[0].style.top=parseInt(t[0].style.top,10)+1+"px"),e.setAttribute("x",e.attributes.x+1)}),r.top=r.top+1,org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()});else if(t){e.preventDefault();var o=ecEditor.jQuery("#"+t.id);0!=o.length&&(o[0].style.top=parseInt(o[0].style.top,10)+1+"px"),t.editorObj.top=t.editorObj.top+1,t.setAttribute("y",t.editorObj.top),org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}}),ecEditor.registerKeyboardCommand("shift+left",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject(),r=org.ekstep.contenteditor.api.getEditorGroup();if(r)e.preventDefault(),_.each(org.ekstep.contenteditor.api.getCurrentGroup(),function(e){var t=ecEditor.jQuery("#"+e.id);0!=t.length&&(t[0].style.left=parseInt(t[0].style.left,10)-1+"px"),e.setAttribute("x",e.attributes.x-1)}),r.left=r.left-1,org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()});else if(t){e.preventDefault();var o=ecEditor.jQuery("#"+t.id);0!=o.length&&(o[0].style.left=parseInt(o[0].style.left,10)-1+"px"),t.editorObj.left=t.editorObj.left-1,t.setAttribute("x",t.editorObj.left),org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}}),ecEditor.registerKeyboardCommand("shift+right",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject(),r=org.ekstep.contenteditor.api.getEditorGroup();if(r)e.preventDefault(),_.each(org.ekstep.contenteditor.api.getCurrentGroup(),function(e){var t=ecEditor.jQuery("#"+e.id);0!=t.length&&(t[0].style.left=parseInt(t[0].style.left,10)+1+"px"),e.setAttribute("x",e.attributes.x+1)}),r.left=r.left+1,org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()});else if(t){e.preventDefault();var o=ecEditor.jQuery("#"+t.id);0!=o.length&&(o[0].style.left=parseInt(o[0].style.left,10)+1+"px"),t.editorObj.left=t.editorObj.left+1,t.setAttribute("x",t.editorObj.left),org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}})},moveRichText:function(e){var t=org.ekstep.contenteditor.api.getEditorGroup();t&&_.each(t.getObjects(),function(e){0!=ecEditor.jQuery("#"+e.id).length&&ecEditor.jQuery("#"+e.id).css({top:t.top+t.height/2+e.top,left:t.left+t.width/2+e.left})})}}))