!function(e){var n={};function t(o){if(n[o])return n[o].exports;var a=n[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,t),a.l=!0,a.exports}t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var a in e)t.d(o,a,function(n){return e[n]}.bind(null,a));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=0)}([function(e,n,t){t(1),t(2),t(3)},function(e,n){(function(){$.fn.SBdynamicForm=function(e){const n="row";var t,o,a,c,i,r,d,s,f;return a={id:"dynamicFormDiv",config:a,data:metadata,showSelectedCount:!1,addHtml:function(e){return!1},submitId:"submit",getFormData:function(){return!1},error:function(e){e()}},$.extend(a,e),o=function(){var t=e.config.templateLayout;0===Object.keys(t).length&&e.error(!0),Object.keys(t)[0]==n?r(t.row,"dynamicFormDiv",n):r(t.col,"dynamicFormDiv","col"),$("#"+a.submitId).click((function(){var n=dependency.getFormValues();console.log(n),e.getFormData(n)}))},validate=function(){return!0},c=function(e,n,t){i();var o=$("#"+e),a=t.name?"cont_"+t.name:n;if(console.log("eleId",a),t.code)var c='<div id="'+n+'" name="'+t.code+'"><p>'+t.name+"</p></div>";else c='<div id="'+n+'"><p>'+t.name+"</p></div>";o.append(c);var r=$("#"+n),d={"flex-grow":t.style&&t.style.width?t.style.width/100:"1"};r.css(d),t&&t.class&&r.addClass(t.class)},i=function(){t&&clearTimeout(t),t=setTimeout((function(){s()}),200)},r=function(e,n,t){e instanceof Array?e.forEach((function(e){d(e,n,t)})):d(e,n,t)},d=function(e,o,a){clearInterval(t),e.class=a+"-container";var i,d=a+Math.random().toString(36).substring(2,15);c(o,d,e),e.row?(i=e.row,r(i,d,n)):e.col&&(i=e.col,r(i,d,"col"))},s=function(){var n=e.config.fields,t=e.config.formData;n.forEach((function(e){dfElements.createElement(e,a.showSelectedCount),"select"!=e.inputType&&"multiselect"!=e.inputType||dfElements.setOptions(e,e.range)})),f((function(){dependency.mapObject(n,t,(function(e){dependency.init(e)}))}))},f=function(e){$.each(a.data,(function(e,n){dfElements.setMetadata(e,n)})),e()},o()}}).call(this),setTimeout((function(){console.log("Loading form with default data"),jQuery("#dynamicFormDiv").SBdynamicForm({id:"dynamicFormDiv",config:formConfig,data:metadata})}),0)},function(e,n){var t={fields:void 0,init:function(e){this.fields=e},getTargetField:function(e){var n=[];return this.fields.forEach((function(t){t.code===e.getAttribute("code")&&(n=t)})),n},updateForm:function(e){e&&e.range&&t.getAssociations($("#df_"+e.code).val(),e.range,(function(n){var o=t.getFormValues();t.getParentAssociations(e,n,o,(function(n){t.applyDependencyRules(e,n,!0)}))}))},getFormValues:function(){var e=new Object;return this.fields.forEach((function(n){e[n.code]=$("#df_"+n.code).val();var t=Array.isArray(e[n.code])?e[n.code].length:e[n.code]?1:0;$("#selectedCount_"+n.code).text(t)})),e},getParentAssociations:function(e,n,o,a){e.parent&&e.parent.length&&e.parent.forEach((function(e){t.fields.forEach((function(a){a.code===e&&a.range.forEach((function(a){Array.isArray(o[e])&&o[e].length>0?o[e].forEach((function(e){a.name===e&&(n=t.getCommonAssociations(a.associations,n))})):a.name===o[e]&&(n=t.getCommonAssociations(a.associations,n))}))}))})),a(n)},getCommonAssociations:function(e,n){var t=[];return e&&e.length&&e.forEach((function(e){n.forEach((function(n){e.code===n.code&&t.push(n)}))})),t},getAssociations:function(e,n,t){var o=[],a=[],c=[];"string"==typeof e?o.push(e):o=[],n.forEach((function(e){o.forEach((function(n,t){e.name===n&&c.push(e)}))})),c.forEach((function(e,n){e.associations&&e.associations.forEach((function(e,n){a.push(e)}))})),t&&t(a)},applyDependencyRules:function(e,n){var o;e.depends&&e.depends.length&&e.depends.forEach((function(e){var a;o=[],n.forEach((function(n){e==n.category&&o.push(n)})),t.fields.forEach((function(n){e!=n.code||(a=n)})),o.length&&dfElements.setOptions(a,o)}))},mapObject:function(e,n,t){this.mapParents(e,(function(n){e=n})),e.forEach((function(e){n.forEach((function(n){e.code===n.code&&(e.range=n.terms)}))})),t(e)},mapParents:function(e,n){return e.forEach((function(n,t){e[t].parent=[]})),e.forEach((function(n,t){n.depends&&n.depends.forEach((function(t){e.forEach((function(o,a){t===o.code&&e[a].parent.push(n.code)}))}))})),n(e)}};window.dependency=t},function(e,n){var t={create:function(){},createElement:function(e,n){switch(e.inputType){case"text":t.addElement(e,"input");break;case"textarea":t.addElement(e,"textarea");break;case"checkbox":t.addElement(e,"input","checkbox");break;case"checkboxstandard":t.addElement(e,"input","checkboxstandard");break;case"radio":t.addElement(e,"input","radio",void 0,n);break;case"select":case"multiselect":t.addElement(e,"select",void 0,n);break;case"label":t.addElement(e,"label");break;default:console.log("no element added")}},addElement:function(e,n,t,o){var a=$('[name ="'+e.code+'"]');if(a){var c=a[0];if(o)var i="<div><span>"+e.name+'</span> (<span id="selectedCount_'+e.code+'">0</span>)</div><'+n+' id="df_'+e.code+'" onChange="dfElements.updateForm(this)" code="'+e.code+'" data="'+e.name+'"></'+n+">";else i="<span>"+e.name+"</span><"+n+' id="df_'+e.code+'" onChange="dfElements.updateForm(this)" code="'+e.code+'" data="'+e.name+'"></'+n+">";"multiselect"===e.inputType&&$("#df_"+e.code).attr("multiple",!0),$(c).html(i),t&&$("#df_"+e.code).attr("type",t)}},updateForm:function(e){var n=dependency.getTargetField(e);dependency.updateForm(n)},getSortedOptions:function(e){return e=e.sort((function(e,n){var t=e.name.toUpperCase(),o=n.name.toUpperCase();return t<o?-1:t>o?1:0}))},getUniqOptions:function(e){let n=[],t={};for(let o of e)t[o.name]||(n.push(o),t[o.name]=!0);return n},setOptions:function(e,n){if("select"==e.inputType||"multiselect"==e.inputType){var t=$("#df_"+e.code);if(t.empty(),t.length){if(t.prop)var o=t.prop("options");else o=t.attr("options");o[0]=new Option(e.placeholder,""),$.each(n,(function(e,n){o[e+1]=n.name?new Option(n.name,n.name):new Option(n,n)}))}}},setSelect:function(e,n){$("#df_"+e+" option:selected").removeAttr("selected"),$("#df_"+e+" option[value="+n+"]").attr("selected",!0)},setMetadata:function(e,n){if($("#df_"+e).length&&Array.isArray(n)){t.setSelect(e,n[0]);var o=n.length||0;$("#selectedCount_"+e).text(o)}else{$("#df_"+e).val(n);o=n?1:0;$("#selectedCount_"+e).text(o)}}};window.dfElements=t}]);